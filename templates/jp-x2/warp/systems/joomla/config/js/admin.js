/* Copyright (C) YOOtheme GmbH, http://www.gnu.org/licenses/gpl.html GNU/GPL */

jQuery(function(e){var a=e("#config"),t=e("#profile"),i=Joomla.submitbutton,n=window.sessionStorage||{};e("#myTabTabs").on("click","[data-toggle]",function(){n._tab=e(this).attr("href")}),setTimeout(function(){n._tab&&e("#myTabTabs [href='"+n._tab+"']").trigger("click")},1),Joomla.submitbutton=function(a){var t=e('form[name="adminForm"]');"style.save"==a?t.trigger("save",["save",a]):"style.save2copy"==a?t.trigger("save",["save-copy",a]):"style.apply"==a?t.trigger("save",["apply",a]):i(a)},e("#templatestyleOptions").length?a.closest("#templatestyleOptions").before(a).remove():a.closest("#details").find("div:first").before(a).hide(),setTimeout(function(){a.find(".chzn-container").each(function(){e(this).prev().show().end().remove()})},200),a.tabs(),t.prependTo("#config li.Profiles").profiles('[data-profile="default"]'),e(window).width()<1200&&e("div.tabs-box").addClass("small-screen"),a.prev("ul.nav").append('<li class="version">Warp '+a.data("warpversion")+"</li>");var s=e("#config ul.verify").hide();e("#config a.verify-link").bind("click",function(e){e.preventDefault(),s.slideToggle()});var o=e("#config ul.systemcheck").hide();e("#config a.systemcheck-link").bind("click",function(e){e.preventDefault(),o.slideToggle()}),e('form[name="adminForm"]').bind("save",function(a,t,n){var s={},o=[],r=e(this),l=e("#toolbar-"+t);l.addClass("saving"),e("#config li.ignore > .field").find("input, select, textarea").each(function(){o.push(e(this).attr("name"))}),e.each(r.serializeArray(),function(a,t){e.inArray(t.name,o)>-1||(s[t.name]=t.value)}),e.ajax({url:r.attr("action"),type:"post",data:e.extend(s,{option:"com_templates",tmpl:"warp-ajax"}),success:function(a){l.removeClass("saving");try{if(a=e.parseJSON(a),"success"!=a.message)return void alert("Save failed!")}catch(t){}i(n)}})})});